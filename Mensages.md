# Mensages

En este documento se describe la estructura de los mensajes entre el cliente y el seridor:

- `0/`: mandado desde el cliente e indica al servidor que el cliente se quiere desconectar
- Registro:
  - Petidion del cliente: `1/nombre*password*email`
  - Respuesta del servidor:
    - `1/0`: El usuario ya existe
    - `1/1`: Se ha registrado exitosamente
    - `1/2`: Se ha producido un error
- Login:
  - Petición del cliente: `2/nombre*password`
  - Respuesta del servidor:
    - `2/0`: Usuario o contraseña incorrectos
    - `2/1`: Se iniciado exitosamente
    - `2/2`: Error
- Ranking:
  - Petición del cliente: `3/`
  - Respuesta del servidor: `3/n/nombre1,nombre2` Donde `n` es el numero de jugadores en el ranking y los nombres estan ordenados en orden descendiente de puntos.
- Lista de conectados
  - Notificación/respuesta del servidor: `4/n/nombre1,nombre2` mismo formato que en el anterior, solo que unicamente se devuelven los usuarios conectados
  - Peticion del cliente: `4/` no es necesaria, ya que el servidor manda automaticamente la lista de conectedos, pero es posible mandar esta peticion para obtenerla.
- Invitar: para este caso seguiremos la logica, ya que facilita la explicación
  - Peticion del cliente: `5/nombre1*nombre2*nombre3` Siendo los `nombre1,nombre2,nombre3` los nombres de los usuarios a invitar
  - Respuestas del servidor:
    - `5/1/n` si se ha poidido mandar la invitación y n es el identificador de partida
    - `5/0`: no se ha podido invitar
- Notificación a los invitados (Solo en el primer caso anterior): `6/n/nombreAmfitrion,invitado1*invitado2*invitado3`
  - Respuesta de los usuarios:
    - `6/1/n` si se quiere participar, donde n es el identificador de partida
    - `6/0/n`: no se quiere participar, donde n es el identificador de partida
- Notificacion de inicio de partida(Solo en el primer caso anterior): `7/n/nombreAmfitrion,invitado1*invitado2*invitado3`
- Partida
  - Mensages del cliente: `8/`
    - `8/0/1`: jugador listo
    - `8/0/0/nombre1*x1*y1*p1*v1,nombre2*x2*y2*p2*v2,nombre3*x3*y3*p3*v3,nombre4*x4*y4*p4*v4|id1*x1*y1,id2*x2*y2,id3*x3*y3,id4*x4*y4` datos de inicio de partida(mandados por el host)
    - `8/1/`: Relacionado con el jugador
      - `8/1/0/nombre*x*y`: posicion del jugador
      - `8/1/1/nombre*m*p`: el jugador ha derrotado al enemigo con id m y su puntuación actual es de p
      - `8/1/2/nombre*m`: el jugador ha sido atacado por m
      - `8/1/3/nombre*m`: el jugador ha muerto a manos de m
    - `8/2/`
      - `8/2/0/id1*x1*y1,id2*x2*y2,id3*x3*y3,id4*x4*y4`: actualización de la posicion de los enemigos (solo lo puede mandar el host)
      - `8/2/1/id*x*y` crear un nuevo enemigo en la posición x,y(solo lo puede mandar el host)
  - Notificaciones servidor
    - `8/0/nombre1*x1*y1*p1*v1,nombre2*x2*y2*p2*v2,nombre3*x3*y3*p3*v3,nombre4*x4*y4*p4*v4|id1*x1*y1,id2*x2*y2,id3*x3*y3,id4*x4*y4` datos de inicio de partida
    - Relacionadas con los jugadores
      - `8/1/0/nombre1*x1*y1*p1*v1,nombre2*x2*y2*p2*v2,nombre3*x3*y3*p3*v3,nombre4*x4*y4*p4*v4` posición, puntación y vidas actuales de los jugadores
      - `8/1/1/nombre*m`: el jugador ha derrotado a m
      - `8/1/2/nombre*m`: el jugador ha sido atacado por m
      - `8/1/3/nombre*m`: el jugador ha muerto a manos de m
    - Relacionada con los enemigos
      - `8/2/0/id1*x1*y1,id2*x2*y2,id3*x3*y3,id4*x4*y4`: actualización de la posicion de los enemigos
      - `8/2/1/id*x*y` crear un nuevo enemigo en la posición x,y(solo lo puede mandar el host)
- Enviar al chat:
  - Peticion del cliente: `9/mensage`
  - Respuesta servidor:
    - `9/0`: no se ha podido mandar el mensage
    - `9/1`: se ha mandado exitosamente
    - `9/2`: error
- Recibir mensages del chat:
  - Peticion cliente: `10/`
  - Notificacion/respuesta del servidor: `10/n/nombre1*timestamp*mensage,nombre2*timestamp2*mensage2...` donde n es el numero de mensages
